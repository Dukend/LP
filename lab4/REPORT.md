# № Отчет по лабораторной работе №4

## по курсу "Логическое программирование"

## Обработка естественного языка

### студент: Кондратьев Е.А.

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |              |               |
| Левинская М.А.|              |     4         |

> *Комментарии проверяющих (обратите внимание, что более подробные комментарии возможны непосредственно в репозитории по тексту программы)*

Грамматика (правила перехода) выписаны не совсем корректно. Приоритет операций должен определяться из грамматики выражения.
## Введение

Проблема обработки языков машиной – одна из первостепенных на данный момент. 
Научить машину понимать язык – крайне сложная, пока что невыполнимая задача, так как перед программистом стоит главный вопрос – как сопоставить передаваемый смысл с предложением. 
Однако уже сейчас многие компании разрабатывают свои алгоритмы обработки языков, которые справляются со своей задачей довольно успешно. 
В реализации таких алгоритмов огромную роль играют свойства, присущие тому или иному языку, так как они структурированы и могут быть запрограммированы. 

Грамматика языка – свойство того или иного языка, почти все алгоритмы обработки языков основаны на грамматиках и именно в зависимости от типа грамматики выбирается и способ обработки языка – так для регулярных автоматик применяется метод конечных автоматов, для контекстно-свободной – строится дерево грамматического разбора и т.д.

Язык пролог хорош для обработки языка тем, что в нем довольно легко сопоставлять различные состояния и правила, можно с легкостью находить различные паттерны, анализировать и редактировать текст.

## Задание

4. Реализовать синтаксический анализатор арифметического выражения для перевода его в префиксную форму. 
В выражении допустимы операции +, -, *, /. 

Пример:

```prolog
?- calculate([5,"+",2,"*",3],Res).
Res = ["+", 5, "*", 2, 3]
```

## Принцип решения

<!--Опишите своими словами принцип решения задачи, приведите важные фрагменты кода.--> 

Грамматика:
Терминальный алфавит:
```
0, 1, 2, 3, 4, 5, 6, 7, 8, 9, +, -, *, /.
```

Нетерминальный алфавит:
```
add(Left,Right), 
subtract(Left,Right), 
multiply(Left,Right), 
divide(Left,Right), 
number(Num).
```

Правила переходов:
```
expr -> apply, number
expr -> number
apply -> expr
apply -> apply, transfer
```

Начало:
```
expr
```

Связывание операций с приоритетом
```prolog
operation("+",1).
operation("-",1).
operation("*",2).
operation("/",2).
```

Предикат разбиения выражения
```prolog
expr(3,[Num|T],T,number(Num)).
expr(N,List,Tail,Expr):-
	N<3,
	N1 is N+1,
	expr(N1,List,TTail,Expr1),
	apply(TTail,Tail,Expr1,Expr,N).
```

Предикат перевода выражения в префиксную форму 
(number, multiply, divide, add, subtract)
```prolog
apply([Operation|T],Tail,Expr1,Expr,N):-
	operation(Operation,N),
	N1 is N+1,
	expr(N1,T,List1,Expr2),!,
	transfer(Operation,Expr1,Expr2,Term),
	apply(List1,Tail,Term,Expr,N).
apply(List,List,Exp,Exp,_).
```
Пример:
Данный список
[12,"+",123,"-",43,"*",3,"-",36,"/",2]
преобразовывается в
subtract(subtract(add(number(12),number(123)),multiply(number(43),number(3))),divide(number(36),number(2)))

Связывание операций с аргументами
```prolog
transfer("+",Left,Right,add(Left,Right)).
transfer("-",Left,Right,subtract(Left,Right)).
transfer("*",Left,Right,multiply(Left,Right)).
transfer("/",Left,Right,divide(Left,Right)).
```

Предикат преобразования префиксной формы выражения из текста в список
```prolog
modify(add(Left,Right),["+"|List]):-
	modify(Left,L1),
	modify(Right,L2),
	append(L1,L2,List).
modify(subtract(Left,Right),["-"|List]):-
	modify(Left,L1),
	modify(Right,L2),
	append(L1,L2,List).
modify(multiply(Left,Right),["*"|List]):-
	modify(Left,L1),
	modify(Right,L2),
	append(L1,L2,List).
modify(divide(Left,Right),["/"|List]):-
	modify(Left,L1),
	modify(Right,L2),
	append(L1,L2,List).
modify(number(N),[N]).
```
Пример:
subtract(subtract(add(number(12),number(123)),multiply(number(43),number(3))),divide(number(36),number(2)))
переходит в 
["-", "-", "+", 12, 123, "*", 43, 3, "/", 36, 2]

Предикат перевода выражения в префиксную форму
```prolog
calculate(List,X):-
	expr(1,List,_,Term),
	modify(Term,X).
```

## Результаты
```prolog
?- calculate([5,"+",2,"*",3],Res).
Res = ["+", 5, "*", 2, 3] .
```

```prolog
?- calculate([12,"+",123,"-",43,"*",3,"-",36,"/",2],Res).
Res = ["-", "-", "+", 12, 123, "*", 43, 3, "/", 36, 2] .
```
## Выводы
В итоге, проанализировав получившуюся программу и мою лабу по этой теме на плюсах, я понимаю, что Prolog ГОРАЗДО более хорошо подходит для задач, связанных с разбором синтаксичеких выражений, программа получилась меньше и более читабельна(в прошлой 370 строк). Это обусловлено декларативной семантикой языка и тем, что составленные правила грамматики напрямую отображаются в предикаты Prolog'a.

Благодаря языку Prolog можно компактно реализовать синтаксические анализаторы выражений и естественно-языковых текстов для их дальнейшей обработки. 

<!--Сформулируйте *содержательные* выводы по лабораторной работе. 
Чему она вас научила? Над чем заставила задуматься? 

Удобным ли оказывается Пролог для решения задач грамматического разбора? Почему?

Помните, что несодержательные выводы -
самая частая причина снижения оценки за лабораторную.-->




